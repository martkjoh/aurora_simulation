\documentclass{article}
\usepackage{physics}
\usepackage{graphicx}
\graphicspath{{./figs/}}

\title{Semester assigment ElMag - Simulation of aurora}
\author{Martin Johsnrud}

\begin{document}
    \maketitle

    Auroras come from charged particles, launch into outer space by sun storms, beeing guided by the magnetic field of the earth down in the atmosphere. (...) 
    
    \section*{Parametres}
        This problem has many parametres, $q, M, R_{\tiny\odot}, m, \mu_0$, which is respectivley the particle charge and mass, the earths mass and magnetic dipole moment and the magnetic peremability of space. These can be reduced to 3, namely characteristic time, length, magnetic field and energy
        \begin{equation*}
            t_0 = \frac{M R_{\tiny\odot}^3}{q m \mu_o}, \quad x_0 = R_{\tiny\odot}, \quad B_0 = \frac{M}{q t_0}, \quad E_0 = \frac{M R_{\tiny\odot}^2}{t_0^2}.
        \end{equation*}
        Real world values for these are  
        \begin{align*}
            & t_0 = \frac{1.6 \cdot 10^{-27}}{1.6\cdot10^{-19}}\frac{(6.47 \cdot 10^6)^3 }{8 \cdot 10^{22} 1.26 \cdot 10^{-6} } = 270 \cdot 10^{-6} \textrm{s}\\
            & x_0 = 6.47 \cdot 10^6 \textrm{m}, \quad
            B_0 = \frac{8 \cdot 10^{22} 1.26 \cdot 10^{-6}}{(6.47 \cdot 10^6)^3} = 0.0037 \cdot 10^{-2} \textrm{kg} \, \textrm{S}^{-2} \, \textrm{A}^{-1}.
        \end{align*}
        These will be used as units through the exercise, however we see that $x_0 / t_0 \sim 240 c$, so we choose to slow down the simulation by a factor $ 5\cdot 10^5$, i.e. using $t0 \cdot 5\cdot 10^5 \sim 135 \textrm{s}$ as the time unit. Then, a typical coronal ejection has speed unity.

    \section*{Magnetic field}
    \paragraph{}
    We can model the earths magnetic field as a diploe. Let the x-axis point from the centre of the earth towards the sun, the y-axis roughly paralel to the earths orbit, and then the z-axis northwards. Let
        \begin{equation*}
            \hat m = \hat e_i \hat m_i
        \end{equation*}
        be the normailzed direction of earths magnetic dipole-moment. The earths magnetic field is then given by
        \begin{equation}
            B_j = \frac{1}{4\pi} \frac{3\hat m_i \hat x_i \hat x_j - \hat m_j}{r^2},
        \end{equation}
        where
        \begin{equation*}
            r = \sqrt{x_ix_i}, \quad \hat x_i = x_i / r.
        \end{equation*}

        Figure \ref{B-field} shows the magnetic field as seen from the eraths orbit, and on the other side than the sun. 
        
        \begin{figure}
            \centering    
            \includegraphics[width=\textwidth]{b_field_2D}
            \caption{The earths magnetic field, in the $xz$- and $yz$-plane.  }
            \label{B-field}
        \end{figure}

    \section*{Charged particles}
        Let $ \hat e_i B_i(x_j)$ be the earths magnetic field. The magnetic force on a particle with charge $q$, position $\hat e_i x_i(t)$ and veloxity $\hat e_i \dot x_i (t)$ is then
        \begin{equation}
            F_i = \epsilon_{ijk} \dot x_j B_k.
        \end{equation}
        By newtons second law, we get the equation of motion for the particle,
        \begin{equation}
            \ddot x_i = \epsilon_{ijk} \dot x_j B_k
        \end{equation}
        Rewriting to a first order set of equations, we get
        \begin{align*}
            \dv{t} y = \dv{t} 
            \begin{pmatrix}
                x_i \\
                \dot x_i
            \end{pmatrix}
            = 
            \begin{pmatrix}
                \dot x_i \\
                \epsilon_{ijk} \dot x_j B_k
            \end{pmatrix}
            = f(y).
        \end{align*}
        This can then be solved numerically by a runge kutta method. This i show in figure \ref{Charged particles}, where several particles with different starting positions are simulated as they aproach the earth, and is deflected by the magnetic field of the earth. The only particels that are able to reach down to earths surface are particles apraoching from higer up, explaining why we only see auroras near the poles.

        \begin{figure}
            \centering
            \vspace{-50px}
            \includegraphics[width=\textwidth ]{charged_particles_2D}
            \caption{Charged particles aproacing earth from different starting points. Evne though the lines may overlap with the earth, it does not mean that they have hit the ground, as the graph only contains two dimensions.}
            \label{Charged particles}
        \end{figure}

    \section*{Accuracy}
    To thest the accuracy of the numerical scheme, one can use the fact tha magnetic forces never does any work on particles, as they always are perpendicular to the velocity of a particle. The potential energy of the particle should thus be conserved, as the simultation does not take into account friction, nor electromagnetic radiation. Kinetic energy is given by
    $$
        E = \frac{1}{2}\dot x^2,
    $$
    in units of $E_0$. Relative error,
    $$
        \Delta E(t) = \frac{|E(t) - E(0)|}{E(0)},
    $$
    is thus a usefull cuantity for evaluating the precission of the simulations. Figure \ref{relative error} shows this for all simulated paths.
    \begin{figure}
        \centering
        \includegraphics[width = \textwidth]{relative_error_energy}
        \label{relative error}
        \caption{The relative shifts in energy, in comparison with the starting values. Particle 3 has the largest value, $2.036 \cdot 10^{-5}$}
    \end{figure}



\end{document}